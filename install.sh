#!/bin/bash
#
# GT-salat-dikr Complete Installation v3.2.5
# ุชุซุจูุช ูุงูู ูุชูุงูู ูุน ุฌููุน ุจูุฆุงุช ุณุทุญ ุงูููุชุจ
#

set -e

# ุฏุงูุฉ ูุนุฑุถ ุงูุฑุฃุณ ุงูููู
show_header() {
    clear
    cat << "EOF"

      ___ _____    ___   _   _      _ _____    ___ ___ _  _____ 
     / __|_   _|__/ __| /_\ | |    /_\_   _|__|   \_ _| |/ / _ \
    | (_ | | ||___\__ \/ _ \| |__ / _ \| ||___| |) | || ' <|   /
     \___| |_|    |___/_/ \_\____/_/ \_\_|    |___/___|_|\_\_|_\
                                                                
     ๐ ูุธุงู ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ ูุงูุฃุฐูุงุฑ - ุงูุฅุตุฏุงุฑ 3.2.5 ๐

EOF
}

show_header

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "     ูุฑุญุจุงู ุจู ูู ุชุซุจูุช GT-salat-dikr!"
echo "     ูุชูุงูู ูุน GNOME, KDE, XFCE, LXDE, MATE ูุบูุฑูุง"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ุงูุชุญูู ูู ุนุฏู ุงูุชุดุบูู ูู root
if [ "$EUID" -eq 0 ]; then
    echo "โ๏ธ  ูุง ุชุดุบู ูุฐุง ุงูุณูุฑุจุช ุจุตูุงุญูุงุช root."
    exit 1
fi

INSTALL_DIR="$HOME/.GT-salat-dikr"
REPO_BASE="https://raw.githubusercontent.com/SalehGNUTUX/GT-salat-dikr/main"
MAIN_SCRIPT="gt-salat-dikr.sh"
CONFIG_FILE="$INSTALL_DIR/settings.conf"
TRAY_SCRIPT="$INSTALL_DIR/gt-tray.py"
DESKTOP_FILE="$INSTALL_DIR/gt-salat-dikr.desktop"
LAUNCHER_FILE="$INSTALL_DIR/launcher.sh"
UNIVERSAL_LAUNCHER="$INSTALL_DIR/launcher-universal.sh"
UNINSTALLER="$INSTALL_DIR/uninstall.sh"

# ---------- ุงููุฑุญูุฉ 1: ุงูุชุซุจูุช ุงูุฃุณุงุณู ----------
echo "๐ฅ ุชุญููู ุงูุจุฑูุงูุฌ..."
mkdir -p "$INSTALL_DIR"
cd "$INSTALL_DIR"

# ุชุญููู ุงููููุงุช ุงูุฃุณุงุณูุฉ
ESSENTIAL_FILES=(
    "$MAIN_SCRIPT"
    "azkar.txt"
    "adhan.ogg"
    "short_adhan.ogg"
    "prayer_approaching.ogg"
    "gt-tray.py"
)

for file in "${ESSENTIAL_FILES[@]}"; do
    echo "  โฌ๏ธ  ุชุญููู: $file"
    curl -fsSL "$REPO_BASE/$file" -o "$file" 2>/dev/null || echo "  โ๏ธ  ูู ูุชู ุชุญููู $file"
done

# ุชุญููู ููู ุฅูุบุงุก ุงูุชุซุจูุช
echo "  โฌ๏ธ  ุชุญููู: uninstall.sh"
curl -fsSL "https://raw.githubusercontent.com/SalehGNUTUX/GT-salat-dikr/main/uninstall.sh" -o "$UNINSTALLER" 2>/dev/null && {
    chmod +x "$UNINSTALLER"
    echo "  โ ุชู ุชุญููู ููู ุฅูุบุงุก ุงูุชุซุจูุช"
} || echo "  โ๏ธ  ูู ูุชู ุชุญููู uninstall.sh"

chmod +x "$MAIN_SCRIPT" "gt-tray.py" 2>/dev/null || true

# ---------- ุงููุฑุญูุฉ 2: ุชุญููู ุงูุฃููููุงุช ----------
echo ""
echo "๐ผ๏ธ  ุชุญููู ุงูุฃููููุงุช..."

ICON_DIR="$INSTALL_DIR/icons"
mkdir -p "$ICON_DIR"

echo "โฌ๏ธ  ุฌุงุฑู ุชุญููู ุงูุฃููููุงุช..."
for size in 16 32 48 64 128 256; do
    icon_url="$REPO_BASE/icons/prayer-icon-${size}.png"
    icon_file="$ICON_DIR/prayer-icon-${size}.png"
    
    if curl -fsSL "$icon_url" -o "$icon_file" 2>/dev/null; then
        echo "  โ ุชู ุชุญููู ุฃููููุฉ ${size}x${size}"
    fi
done

# ---------- ุงููุฑุญูุฉ 3: ุฅูุดุงุก Launcher ูุญุณูู ูุน ุฑุณุงูุฉ ุงูุชูุฏู ----------
echo ""
echo "๐ง ุฅูุดุงุก ููุดุบูู ุฐูู ูุน ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ..."

# ุฅูุดุงุก launcher.sh ุจุดูู ูุจุณุท ุฃููุงู ูููุน ุงูุฃุฎุทุงุก
cat > "$LAUNCHER_FILE" << 'LAUNCHER_EOF'
#!/bin/bash
#
# GT-salat-dikr Launcher v2.1
# ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ ูุน ุฑุณุงุฆู ุชูุฏู
#

set -e

INSTALL_DIR="$(dirname "$(realpath "$0")")"
TRAY_SCRIPT="$INSTALL_DIR/gt-tray.py"
MAIN_SCRIPT="$INSTALL_DIR/gt-salat-dikr.sh"
LOCK_FILE="/tmp/gt-salat-launcher.lock"

# ุฃููุงู ูููุงุฌูุฉ
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
NC='\033[0m' # No Color

# ุฏุงูุฉ ูุนุฑุถ ุฅุทุงุฑ ุฌููู
show_box() {
    local width=50
    local text="$1"
    local padding=$(( (width - ${#text} - 2) / 2 ))
    
    echo -e "${PURPLE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    printf "${PURPLE}โ${NC}%*s${WHITE}%s${NC}%*s${PURPLE}โ${NC}\n" $padding "" "$text" $padding ""
    echo -e "${PURPLE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
}

# ุฏุงูุฉ ููุชุญูู ูู System Tray
check_tray_running() {
    if pgrep -f "gt-tray.py" >/dev/null 2>&1; then
        return 0
    fi
    return 1
}

# ุฏุงูุฉ ุจุฏุก System Tray
start_tray() {
    echo ""
    show_box "๐ GT-salat-dikr"
    echo ""
    echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${GREEN}        ุฌุงุฑู ุชุดุบูู System Tray...${NC}"
    echo -e "${YELLOW}        โณ ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ 5-10 ุซูุงูู${NC}"
    echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
    
    echo -e "${CYAN}โณ [ุงูุฎุทูุฉ 1]${NC} ${WHITE}ุงูุชุญูู ูู ูุชุทูุจุงุช ุงููุธุงู...${NC}"
    if ! command -v python3 >/dev/null 2>&1; then
        echo -e "${RED}โ Python3 ุบูุฑ ูุซุจุช${NC}"
        return 1
    fi
    
    echo -e "${CYAN}โณ [ุงูุฎุทูุฉ 2]${NC} ${WHITE}ุชุญููู ููุชุจุงุช Python...${NC}"
    if ! python3 -c "import pystray, PIL" 2>/dev/null; then
        echo -e "${YELLOW}โ๏ธ  ุงูููุชุจุงุช ุบูุฑ ูุซุจุชุฉุ ูุฏ ูุณุชุบุฑู ููุชุงู ุฃุทูู${NC}"
    fi
    
    echo -e "${CYAN}โณ [ุงูุฎุทูุฉ 3]${NC} ${WHITE}ุชููุฆุฉ ุจูุฆุฉ ุงููุณุชุฎุฏู...${NC}"
    export DISPLAY="${DISPLAY:-:0}"
    export DBUS_SESSION_BUS_ADDRESS="${DBUS_SESSION_BUS_ADDRESS:-unix:path=/run/user/$(id -u)/bus}"
    
    echo -e "${CYAN}โณ [ุงูุฎุทูุฉ 4]${NC} ${WHITE}ุชุดุบูู System Tray...${NC}"
    echo -e "${BLUE}   ๐ ุฌุงุฑู ุงูุชุดุบูู (ูุฏ ูุณุชุบุฑู ุจุถุน ุซูุงูู)...${NC}"
    
    # ุชุดุบูู ูู ุงูุฎูููุฉ
    cd "$INSTALL_DIR"
    python3 "$TRAY_SCRIPT" >/dev/null 2>&1 &
    local tray_pid=$!
    
    # ุนุฑุถ ูุคุดุฑ ุชูุฏู ูุชุญุฑู
    echo -n "${CYAN}   "
    for i in {1..10}; do
        echo -n "โ"
        sleep 0.5
    done
    echo "${NC}"
    
    sleep 2
    
    if ps -p $tray_pid >/dev/null 2>&1; then
        echo ""
        echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo -e "${GREEN}โ ุชู ุงูุชุดุบูู ุจูุฌุงุญ!${NC}"
        echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo ""
        echo -e "${WHITE}๐ ูุงุฐุง ููููู ุฃู ุชูุนู ุงูุขู:${NC}"
        echo -e "${CYAN}  1. ๐ ุงุจุญุซ ุนู ุงูุฃููููุฉ ูู ุดุฑูุท ุงูููุงู${NC}"
        echo -e "${CYAN}  2. ๐ฑ๏ธ  ุงููุฑ ุจุฒุฑ ุงููุงูุณ ุงูุฃููู ููุชุญูู${NC}"
        echo -e "${CYAN}  3. โ๏ธ  ุงุณุชุฎุฏู 'gtsalat' ูู ุงูุทุฑููุฉ ูููุฒูุฏ${NC}"
        echo ""
        echo -e "${YELLOW}๐ก ุงููุงูุฐุฉ ุณุชูุบูู ุชููุงุฆูุงู ุฎูุงู 10 ุซูุงูู...${NC}"
        
        # ุญูุธ PID
        echo $tray_pid > "/tmp/gt-salat-tray.pid"
        
        # ุฅุบูุงู ุงููุงูุฐุฉ ุจุนุฏ 10 ุซูุงูู
        sleep 10
        return 0
    else
        echo ""
        echo -e "${RED}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo -e "${RED}โ ุชุนุฐุฑ ุชุดุบูู System Tray${NC}"
        echo -e "${RED}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo ""
        echo -e "${YELLOW}๐ง ุงูุญููู ุงูููุชุฑุญุฉ:${NC}"
        echo -e "${WHITE}  1. ุชุฃูุฏ ูู ุชุซุจูุช Python3${NC}"
        echo -e "${WHITE}  2. ุซุจุช ุงูููุชุจุงุช: pip install pystray pillow${NC}"
        echo -e "${WHITE}  3. ุญุงูู ุชุดุบูู: gtsalat --tray${NC}"
        echo ""
        read -p "ุงุถุบุท Enter ููุฅุบูุงู... "
        return 1
    fi
}

# ุฏุงูุฉ ุงูุนุฑุถ ุงูุฑุฆูุณูุฉ
main_menu() {
    clear
    show_box "GT-salat-dikr - ููุญุฉ ุงูุชุญูู"
    echo ""
    
    if check_tray_running; then
        echo -e "${GREEN}โ System Tray ูุนูู ุจุงููุนู${NC}"
        echo ""
        echo -e "${CYAN}๐ ูุนูููุงุช ุงูุตูุงุฉ ุงูุญุงููุฉ:${NC}"
        echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        "$MAIN_SCRIPT" 2>/dev/null || echo -e "${YELLOW}ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...${NC}"
        echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo ""
        echo -e "${WHITE}๐ก ุงูุฃููููุฉ ูุดุทุฉ ูู ุดุฑูุท ุงูููุงู${NC}"
        echo -e "${WHITE}๐ฑ๏ธ  ุงููุฑ ุจุฒุฑ ุงููุงูุณ ุงูุฃููู ููุชุญูู${NC}"
        echo ""
        read -p "ุงุถุบุท Enter ููุฅุบูุงู... "
    else
        echo -e "${YELLOW}โ๏ธ  System Tray ุบูุฑ ูุดุท${NC}"
        echo ""
        echo -e "${WHITE}ูุงุฐุง ุชุฑูุฏ ุฃู ุชูุนูุ${NC}"
        echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo -e "  ${GREEN}1. ๐ ุชุดุบูู System Tray${NC}"
        echo -e "  ${BLUE}2. ๐ ุนุฑุถ ููุงููุช ุงูุตูุงุฉ${NC}"
        echo -e "  ${PURPLE}3. โ๏ธ  ูุชุญ ุงูุฅุนุฏุงุฏุงุช${NC}"
        echo -e "  ${CYAN}4. โ ุงููุณุงุนุฏุฉ${NC}"
        echo -e "  ${RED}5. โ ุฎุฑูุฌ${NC}"
        echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo ""
        
        read -p "ุงุฎุชุฑ ุฑูู ุงูุฅุฌุฑุงุก [1-5]: " choice
        
        case $choice in
            1)
                start_tray
                ;;
            2)
                clear
                show_box "ููุงููุช ุงูุตูุงุฉ ุงูููู"
                echo ""
                "$MAIN_SCRIPT" --show-timetable 2>/dev/null || echo "ุชุนุฐุฑ ุชุญููู ุงูููุงููุช"
                echo ""
                read -p "ุงุถุบุท Enter ููุนูุฏุฉ... "
                main_menu
                ;;
            3)
                clear
                show_box "ุฅุนุฏุงุฏุงุช ุงูุจุฑูุงูุฌ"
                echo ""
                "$MAIN_SCRIPT" --settings
                echo ""
                read -p "ุงุถุบุท Enter ููุนูุฏุฉ... "
                main_menu
                ;;
            4)
                clear
                show_box "ูุณุงุนุฏุฉ GT-salat-dikr"
                echo ""
                "$MAIN_SCRIPT" --help | head -40
                echo ""
                read -p "ุงุถุบุท Enter ููุนูุฏุฉ... "
                main_menu
                ;;
            5)
                echo ""
                echo -e "${GREEN}๐ ูุน ุงูุณูุงูุฉ!${NC}"
                echo ""
                sleep 2
                ;;
            *)
                echo -e "${RED}โ ุงุฎุชูุงุฑ ุบูุฑ ุตุงูุญ${NC}"
                sleep 2
                main_menu
                ;;
        esac
    fi
}

# ุงูุชุญูู ูู ุงูููู
if [ -f "$LOCK_FILE" ]; then
    echo -e "${YELLOW}โ๏ธ  ุงูุจุฑูุงูุฌ ูุนูู ุจุงููุนู${NC}"
    exit 0
fi

touch "$LOCK_FILE"
trap "rm -f '$LOCK_FILE'" EXIT

# ุจุฏุก ุงููุงุฌูุฉ
main_menu

exit 0
LAUNCHER_EOF

chmod +x "$LAUNCHER_FILE"

# ---------- ุงููุฑุญูุฉ 4: ุฅูุดุงุก Launcher ุนุงููู ูุชูุงูู ูุน ุฌููุน ุจูุฆุงุช ุณุทุญ ุงูููุชุจ ----------
echo ""
echo "๐ ุฅูุดุงุก Launcher ุนุงููู ูุชูุงูู ูุน ุฌููุน ุจูุฆุงุช ุณุทุญ ุงูููุชุจ..."

# ุฅูุดุงุก universal launcher ุจุดูู ุฃุจุณุท
cat > "$UNIVERSAL_LAUNCHER" << 'UNIVERSAL_EOF'
#!/bin/bash
#
# GT-salat-dikr Universal Launcher v1.0
# ูุนูู ุนูู GNOME, KDE, XFCE, LXDE, MATE, ูุบูุฑูุง
#

set -e

INSTALL_DIR="$(dirname "$(realpath "$0")")"

# ุฃููุงู ูููุงุฌูุฉ
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
NC='\033[0m'

# ุนุฑุถ ุฑุณุงูุฉ ุชุฑุญูุจูุฉ
clear
echo -e "${PURPLE}"
cat << "LOGO_EOF"

      ___ _____    ___   _   _      _ _____    ___ ___ _  _____ 
     / __|_   _|__/ __| /_\ | |    /_\_   _|__|   \_ _| |/ / _ \
    | (_ | | ||___\__ \/ _ \| |__ / _ \| ||___| |) | || ' <|   /
     \___| |_|    |___/_/ \_\____/_/ \_\_|    |___/___|_|\_\_|_\
                                                                
LOGO_EOF

echo -e "${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${GREEN}   GT-salat-dikr - Launcher ุนุงููู${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${YELLOW}๐ ูุฐุง Launcher ูุนูู ุนูู:${NC}"
echo -e "   โข GNOME / Ubuntu"
echo -e "   โข KDE Plasma"
echo -e "   โข XFCE"
echo -e "   โข MATE"
echo -e "   โข LXDE / LXQt"
echo -e "   โข ูุฃู ุจูุฆุฉ ุฃุฎุฑู"
echo ""

# ุฏุงูุฉ ููุนุซูุฑ ุนูู terminal ููุงุณุจ
find_terminal() {
    echo -e "${BLUE}๐ ุงูุจุญุซ ุนู terminal ููุงุณุจ ูุจูุฆุชู...${NC}"
    
    # ูุงุฆูุฉ ุจุงูู terminals ุงููุฏุนููุฉ
    terminals=("gnome-terminal" "konsole" "xfce4-terminal" "mate-terminal" 
               "lxterminal" "terminator" "xterm" "st" "alacritty" "kitty")
    
    # ุฃููุงู: ุงูุชุดุงู ุจูุฆุฉ ุณุทุญ ุงูููุชุจ
    local desktop_env=""
    if [ -n "$XDG_CURRENT_DESKTOP" ]; then
        desktop_env="$XDG_CURRENT_DESKTOP"
    elif [ -n "$DESKTOP_SESSION" ]; then
        desktop_env="$DESKTOP_SESSION"
    fi
    
    echo -e "${PURPLE}๐ ุจูุฆุฉ ุณุทุญ ุงูููุชุจ: ${desktop_env:-ุบูุฑ ูุนุฑููุฉ}${NC}"
    
    # ุชุญุฏูุฏ terminals ููุถูุฉ ุญุณุจ ุงูุจูุฆุฉ
    case "$desktop_env" in
        *GNOME*|*Ubuntu*|*ubuntu*)
            preferred=("gnome-terminal" "terminator" "xterm")
            ;;
        *KDE*|*Plasma*)
            preferred=("konsole" "xterm" "gnome-terminal")
            ;;
        *XFCE*)
            preferred=("xfce4-terminal" "xterm" "terminator")
            ;;
        *MATE*)
            preferred=("mate-terminal" "xterm" "gnome-terminal")
            ;;
        *LXDE*|*LXQt*)
            preferred=("lxterminal" "xterm" "terminator")
            ;;
        *)
            preferred=("xterm" "gnome-terminal" "konsole" "xfce4-terminal")
            ;;
    esac
    
    # ุงูุจุญุซ ูู ุงูููุถูุฉ ุฃููุงู
    for term in "${preferred[@]}"; do
        if command -v "$term" >/dev/null 2>&1; then
            echo -e "${GREEN}โ ุชู ุงูุนุซูุฑ ุนูู: $term${NC}"
            echo "$term"
            return 0
        fi
    done
    
    # ุงูุจุญุซ ูู ุฌููุน terminals
    for term in "${terminals[@]}"; do
        if command -v "$term" >/dev/null 2>&1; then
            echo -e "${GREEN}โ ุชู ุงูุนุซูุฑ ุนูู: $term${NC}"
            echo "$term"
            return 0
        fi
    done
    
    # ุฅุฐุง ูู ูุนุซุฑ ุนูู ุฃู terminal
    echo -e "${YELLOW}โ๏ธ  ูู ูุชู ุงูุนุซูุฑ ุนูู terminal ููุงุณุจ${NC}"
    echo ""
    return 1
}

# ุฏุงูุฉ ูุจุฏุก ุงูุจุฑูุงูุฌ
launch_gt_salat() {
    local terminal=$(find_terminal)
    
    if [ -z "$terminal" ]; then
        # ูุง ููุฌุฏ terminalุ ุชุดุบูู ูุจุงุดุฑุฉ
        echo -e "${YELLOW}๐ฑ ุฌุงุฑู ุงูุชุดุบูู ูู ุงููุงูุฐุฉ ุงูุญุงููุฉ...${NC}"
        echo ""
        cd "$INSTALL_DIR"
        ./launcher.sh
        echo ""
        echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
        read -p "ุงุถุบุท Enter ููุฅุบูุงู... "
    else
        # ุงุณุชุฎุฏู ุงูู terminal ุงูููุงุณุจ
        echo -e "${GREEN}๐ ุฌุงุฑู ุชุดุบูู GT-salat-dikr...${NC}"
        echo ""
        
        # ุจูุงุก ุฃูุฑ ุงูุชุดุบูู
        local launch_cmd="cd '$INSTALL_DIR' && ./launcher.sh"
        
        # ุชูููุฐ ูุน terminal ููุงุณุจ
        case "$terminal" in
            "gnome-terminal")
                gnome-terminal -- bash -c "$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงููุงูุฐุฉ ุณุชูุบูู ุชููุงุฆูุงู ุฎูุงู 10 ุซูุงูู...'; sleep 10"
                ;;
            "konsole")
                konsole -e bash -c "$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงุถุบุท Enter ููุฅุบูุงู...'; read"
                ;;
            "xfce4-terminal")
                xfce4-terminal -e bash -c "$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงุถุบุท Enter ููุฅุบูุงู...'; read"
                ;;
            "xterm")
                xterm -e bash -c "$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงููุงูุฐุฉ ุณุชูุบูู ุชููุงุฆูุงู ุฎูุงู 10 ุซูุงูู...'; sleep 10"
                ;;
            *)
                # ููู terminals ุงูุฃุฎุฑูุ ูุญุงููุฉ ุนุงูุฉ
                if [[ "$terminal" == "terminator" ]]; then
                    terminator -e "bash -c \"$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงุถุบุท Enter ููุฅุบูุงู...'; read\""
                elif [[ "$terminal" == "mate-terminal" ]]; then
                    mate-terminal -e "bash -c \"$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงุถุบุท Enter ููุฅุบูุงู...'; read\""
                elif [[ "$terminal" == "lxterminal" ]]; then
                    lxterminal -e "bash -c \"$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงุถุบุท Enter ููุฅุบูุงู...'; read\""
                else
                    # ูุญุงููุฉ ุชุดุบูู ุจุฃู ุทุฑููุฉ
                    $terminal -e "bash -c \"$launch_cmd; echo; echo 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ'; echo 'ุงุถุบุท Enter ููุฅุบูุงู...'; read\""
                fi
                ;;
        esac
    fi
}

# ุจุฏุก ุงูุจุฑูุงูุฌ
launch_gt_salat

exit 0
UNIVERSAL_EOF

chmod +x "$UNIVERSAL_LAUNCHER"

# ---------- ุงููุฑุญูุฉ 5: ุฅูุดุงุก ููู .desktop ุนุงููู ----------
echo ""
echo "๐ฅ๏ธ  ุฅูุดุงุก ููู ุชุทุจูู ุนุงููู ูู ูุงุฆูุฉ ุงูุจุฑุงูุฌ..."

cat > "$DESKTOP_FILE" << EOF
[Desktop Entry]
Version=1.0
Type=Application
Name=GT-salat-dikr
GenericName=Prayer Times & Azkar Notifications
Comment=ูุธุงู ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ ูุงูุฃุฐูุงุฑ ูุน System Tray
Exec=bash -c "cd '$INSTALL_DIR' && ./launcher-universal.sh"
Icon=$INSTALL_DIR/icons/prayer-icon-64.png
Terminal=false
StartupNotify=false
Categories=Education;Utility;
Keywords=prayer;islam;azkar;reminder;ุตูุงุฉ;ุฃุฐูุงุฑ;ุฅุณูุงู;ุชุฐููุฑ;
X-GNOME-FullName=GT-salat-dikr Prayer Reminder
StartupWMClass=gt-salat-dikr
EOF

# ูุณุฎ ููู .desktop ูููุงูุน ูุชุนุฏุฏุฉ
echo "๐ ูุณุฎ ููู ุงูุชุทุจูู ุฅูู ููุงุฆู ุงููุธุงู..."

# ุฅูุดุงุก ุงูุฏูุงุฆู ุงููุงุฒูุฉ
mkdir -p "$HOME/.local/share/applications"
mkdir -p "$HOME/Desktop"

# ูุณุฎ ุฅูู ููุงูุน ูุฎุชููุฉ
DESKTOP_LOCATIONS=(
    "$HOME/.local/share/applications/gt-salat-dikr.desktop"
    "$HOME/Desktop/gt-salat-dikr.desktop"
)

for location in "${DESKTOP_LOCATIONS[@]}"; do
    cp "$DESKTOP_FILE" "$location" 2>/dev/null && echo "  โ ุชู ุงููุณุฎ ุฅูู: $location"
done

# ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชุทุจููุงุช
if command -v update-desktop-database >/dev/null 2>&1; then
    update-desktop-database ~/.local/share/applications/ 2>/dev/null && \
    echo "  โ ุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูุชุทุจููุงุช"
fi

# ---------- ุงููุฑุญูุฉ 6: ุฅูุดุงุก ุฑูุงุจุท ููุฃูุงูุฑ ----------
echo ""
echo "๐ ุฅูุดุงุก ุฑูุงุจุท ููุฃูุงูุฑ..."

mkdir -p "$HOME/.local/bin"

# ุฅูุดุงุก ุฑูุงุจุท ููุฃูุงูุฑ
if [ -f "$INSTALL_DIR/$MAIN_SCRIPT" ]; then
    ln -sf "$INSTALL_DIR/$MAIN_SCRIPT" "$HOME/.local/bin/gtsalat" 2>/dev/null && \
    echo "  โ gtsalat - ุชู ุฅูุดุงุก ุงูุฑุงุจุท"
fi

if [ -f "$LAUNCHER_FILE" ]; then
    ln -sf "$LAUNCHER_FILE" "$HOME/.local/bin/gt-launcher" 2>/dev/null && \
    echo "  โ gt-launcher - ุชู ุฅูุดุงุก ุงูุฑุงุจุท"
fi

if [ -f "$UNIVERSAL_LAUNCHER" ]; then
    ln -sf "$UNIVERSAL_LAUNCHER" "$HOME/.local/bin/gt-salat-launcher" 2>/dev/null && \
    echo "  โ gt-salat-launcher - ุชู ุฅูุดุงุก ุงูุฑุงุจุท"
fi

# ุฅุถุงูุฉ ุฅูู PATH ุฅุฐุง ูู ููู ููุฌูุฏุงู
if [[ ":$PATH:" != *":$HOME/.local/bin:"* ]]; then
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> "$HOME/.bashrc"
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> "$HOME/.profile"
    export PATH="$HOME/.local/bin:$PATH"
    echo "  โ ุชู ุฅุถุงูุฉ $HOME/.local/bin ุฅูู PATH"
fi

# ---------- ุงููุฑุญูุฉ 7: ุฅุนุฏุงุฏ ุงูุชุดุบูู ุงูุชููุงุฆู ----------
echo ""
echo "๐ง ุฅุนุฏุงุฏ ุงูุชุดุบูู ุงูุชููุงุฆู ุนูุฏ ุงูุฅููุงุน..."

mkdir -p "$HOME/.config/autostart"
AUTOSTART_FILE="$HOME/.config/autostart/gt-salat-dikr.desktop"

cat > "$AUTOSTART_FILE" << AUTOSTART_EOF
[Desktop Entry]
Type=Application
Name=GT-salat-dikr (Auto-start)
Comment=Start prayer notifications on login
Exec=bash -c 'sleep 25 && cd "$INSTALL_DIR" && ./gt-salat-dikr.sh --notify-start >/dev/null 2>&1 && sleep 15 && python3 ./gt-tray.py >/dev/null 2>&1 &'
Icon=$INSTALL_DIR/icons/prayer-icon-32.png
Hidden=false
NoDisplay=true
X-GNOME-Autostart-enabled=true
Terminal=false
Categories=Utility;
StartupNotify=false
X-GNOME-Autostart-Delay=25
AUTOSTART_EOF

echo "  โ ุชู ุฅูุดุงุก ููู ุงูุชุดุบูู ุงูุชููุงุฆู"

# ุฅุนุฏุงุฏ ูู KDE ุฃูุถูุง
if [ -d "$HOME/.config/plasma-workspace/env" ]; then
    mkdir -p "$HOME/.config/plasma-workspace/env"
    KDE_AUTOSTART="$HOME/.config/plasma-workspace/env/gt-salat-dikr.sh"
    
    cat > "$KDE_AUTOSTART" << 'KDE_EOF'
#!/bin/bash
sleep 30
cd "$HOME/.GT-salat-dikr"
./gt-salat-dikr.sh --notify-start >/dev/null 2>&1 &
sleep 20
python3 ./gt-tray.py >/dev/null 2>&1 &
KDE_EOF
    
    chmod +x "$KDE_AUTOSTART"
    echo "  โ ุชู ุฅุนุฏุงุฏ ุงูุชุดุบูู ุงูุชููุงุฆู ูู KDE Plasma"
fi

echo "โ ุชู ุฅุนุฏุงุฏ ุงูุชุดุบูู ุงูุชููุงุฆู"

# ---------- ุงููุฑุญูุฉ 8: ุชุซุจูุช ููุชุจุงุช Python ----------
echo ""
echo "๐ฆ ุงูุชุญูู ูู ููุชุจุงุช Python..."

install_python_deps() {
    echo "  ๐ ุฌุงุฑู ุงูุชุญูู ูู ููุชุจุงุช Python..."
    
    # ุงูุชุญูู ูู Python3
    if ! command -v python3 >/dev/null 2>&1; then
        echo "  โ๏ธ  Python3 ุบูุฑ ูุซุจุช"
        echo "  ๐ก ุฌุงุฑู ุงูุชุซุจูุช..."
        
        if command -v apt >/dev/null 2>&1; then
            sudo apt update && sudo apt install -y python3 python3-pip
        elif command -v pacman >/dev/null 2>&1; then
            sudo pacman -Sy --noconfirm python python-pip
        elif command -v dnf >/dev/null 2>&1; then
            sudo dnf install -y python3 python3-pip
        else
            echo "  โ ุชุนุฐุฑ ุชุซุจูุช Python3 ุชููุงุฆูุงู"
            return 1
        fi
    fi
    
    # ุงูุชุญูู ูู ุงูููุชุจุงุช
    if python3 -c "import pystray, PIL" 2>/dev/null; then
        echo "  โ ุงูููุชุจุงุช ูุซุจุชุฉ ุจุงููุนู"
        return 0
    fi
    
    echo "  ๐ฅ ุฌุงุฑู ุชุซุจูุช ุงูููุชุจุงุช (ูุฏ ูุณุชุบุฑู ุฏูููุฉ)..."
    
    # ูุญุงููุฉ ุงูุชุซุจูุช ุจู pip
    if python3 -m pip install --user pystray pillow 2>/dev/null; then
        echo "  โ ุชู ุงูุชุซุจูุช ุจุงุณุชุฎุฏุงู pip"
        return 0
    fi
    
    # ูุญุงููุฉ ูุน ูุฏูุฑ ุงูุญุฒู
    if command -v apt >/dev/null 2>&1; then
        echo "  ๐ง ูุญุงููุฉ ุงูุชุซุจูุช ุจุงุณุชุฎุฏุงู apt..."
        sudo apt update && sudo apt install -y python3-pystray python3-pil 2>/dev/null && {
            echo "  โ ุชู ุงูุชุซุจูุช ุจุงุณุชุฎุฏุงู apt"
            return 0
        }
    fi
    
    echo "  โ๏ธ  ุชุนุฐุฑ ุชุซุจูุช ุงูููุชุจุงุช ุชููุงุฆูุงู"
    echo "  ๐ก ููููู ุชุซุจูุชูุง ูุฏููุงู ูุงุญูุงู:"
    echo "     pip install --user pystray pillow"
    echo "  ุฃู"
    echo "     sudo apt install python3-pystray python3-pil"
    return 1
}

install_python_deps

# ---------- ุงููุฑุญูุฉ 9: ุจุฏุก ุงูุฎุฏูุงุช ุงูุขู ----------
echo ""
echo "๐ ุจุฏุก ุชุดุบูู ุงูุจุฑูุงูุฌ ุงูุขู..."

# ุจุฏุก ุงูุฅุดุนุงุฑุงุช
echo "๐ ุจุฏุก ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ..."
cd "$INSTALL_DIR"
if [ -f "$MAIN_SCRIPT" ]; then
    "$MAIN_SCRIPT" --notify-start >/dev/null 2>&1 &
    echo "  โ ุชู ุจุฏุก ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ"
else
    echo "  โ๏ธ  ุชุนุฐุฑ ุงูุนุซูุฑ ุนูู ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณู"
fi

sleep 5

# ุจุฏุก System Tray (ุจุนุฏ ุชุฃุฎูุฑ)
echo "๐ฅ๏ธ  ุฌุงุฑู ุชุดุบูู System Tray (ูุฏ ูุณุชุบุฑู 10-15 ุซูุงูู)..."
if [ -f "$TRAY_SCRIPT" ]; then
    bash -c "sleep 12 && cd '$INSTALL_DIR' && python3 gt-tray.py >/dev/null 2>&1 &" &
    echo "  โ ุชู ุจุฏุก System Tray"
else
    echo "  โ๏ธ  ุชุนุฐุฑ ุงูุนุซูุฑ ุนูู System Tray"
fi

# ---------- ุงููุฑุญูุฉ 10: ุงูุฑุณุงูุฉ ุงูููุงุฆูุฉ ุงูุชุฑุญูุจูุฉ ----------
sleep 3
clear
show_header
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ูุจุฑูู! ุชู ุชุซุจูุช GT-salat-dikr ุจูุฌุงุญ ๐"
echo ""
echo "โจ ุงูููุฒุงุช ุงููุซุจุชุฉ ูู ุงูุฅุตุฏุงุฑ 3.2.5:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ 1. Launcher ุนุงููู - ูุนูู ุนูู ุฌููุน ุจูุฆุงุช ุณุทุญ ุงูููุชุจ"
echo "โ 2. ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ ูุน ุฑุณุงุฆู ุชูุฏู ุฌูููุฉ"
echo "โ 3. ุฃููููุฉ ูู ูุณูู: ุงูุชุนููู (Education) ูุงูุฃุฏูุงุช (Utility)"
echo "โ 4. System Tray ูุธูุฑ ูุน ุฑุณุงูุฉ:"
echo "    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "    โ      ๐ GT-salat-dikr                โ"
echo "    โ      โโโโโโโโโโโโโโโโโโโโโโโโ       โ"
echo "    โ      ุฌุงุฑู ุชุดุบูู System Tray...      โ"
echo "    โ      โณ ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ 5-10 ุซูุงูู  โ"
echo "    โ      ...                            โ"
echo "    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ 5. ุชุดุบูู ุชููุงุฆู ุนูุฏ ุฅููุงุน ุงููุธุงู"
echo "โ 6. ูุชูุงูู ูุน: GNOME, KDE, XFCE, LXDE, MATE ูุบูุฑูุง"
echo "โ 7. ููู ุฅูุบุงุก ุชุซุจูุช ุฌุงูุฒ"
echo "โ 8. ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ ูุงูุฃุฐูุงุฑ ุงูุชููุงุฆูุฉ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ููููุฉ ุงูุจุฏุก:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. ๐ ุงุจุญุซ ุนู 'GT-salat-dikr' ูู ูุงุฆูุฉ ุงูุจุฑุงูุฌ"
echo "   (ุณุชุฌุฏู ูู ูุณูู: Education ู Utility)"
echo "2. ๐ฑ๏ธ  ุงููุฑ ุนูู ุงูุฃููููุฉ - ุณุชุนูู ุนูู ุฃู ุจูุฆุฉ ุณุทุญ ููุชุจ"
echo "3. โณ ุงูุชุธุฑ 5-10 ุซูุงูู ุญุชู ุชุธูุฑ ุฑุณุงูุฉ ุงูุชูุฏู"
echo "4. ๐ ุงุจุญุซ ุนู ุงูุฃููููุฉ ูู ุดุฑูุท ุงูููุงู"
echo "5. ๐ฑ๏ธ  ุงููุฑ ุจุฒุฑ ุงููุงูุณ ุงูุฃููู ุนูู ุงูุฃููููุฉ ููุชุญูู"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ง ุงูุฃูุงูุฑ ุงููุชุงุญุฉ ูู ุงูุทุฑููุฉ:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "gtsalat                    # ุนุฑุถ ุฐูุฑ ูููุนุฏ ุงูุตูุงุฉ"
echo "gtsalat --status          # ุญุงูุฉ ุงูุจุฑูุงูุฌ"
echo "gtsalat --show-timetable  # ููุงููุช ุงูููู"
echo "gtsalat --settings        # ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช"
echo "gt-launcher               # ูุงุฌูุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ"
echo "gt-salat-launcher         # Launcher ุนุงููู (ูุฌููุน ุงูุจูุฆุงุช)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ุงููููุงุช ุงููุซุจุชุฉ:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ ุงููุซุจุช:           $INSTALL_DIR/"
echo "๐ Launcher:         $LAUNCHER_FILE"
echo "๐ Launcher ุนุงููู:  $UNIVERSAL_LAUNCHER"
echo "๐ System Tray:      $TRAY_SCRIPT"
echo "๐ ุฅูุบุงุก ุชุซุจูุช:      $UNINSTALLER"
echo "๐ ุงูุฅุนุฏุงุฏุงุช:        $CONFIG_FILE"
echo "๐ ุฃููููุฉ ุงููุงุฆูุฉ:   $HOME/.local/share/applications/gt-salat-dikr.desktop"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ูุฅูุบุงุก ุงูุชุซุจูุช:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "bash $UNINSTALLER"
echo "ุฃู"
echo "gtsalat --uninstall"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ุงูุชูุงูู:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โข โ GNOME / Ubuntu / Debian"
echo "โข โ KDE Plasma / Kubuntu"
echo "โข โ XFCE / Xubuntu"
echo "โข โ MATE / Ubuntu MATE"
echo "โข โ LXDE / LXQt / Lubuntu"
echo "โข โ ุฃู ุจูุฆุฉ ุณุทุญ ููุชุจ ุฃุฎุฑู"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ุงูุฏุนู ูุงููุตุงุฏุฑ:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โข ๐ ุงููุณุชูุฏุน: https://github.com/SalehGNUTUX/GT-salat-dikr"
echo "โข ๐ ุงูุฅุจูุงุบ ุนู ูุดุงูู: ููุณ ุงูุฑุงุจุท ูู Issues"
echo "โข ๐ก ุงูุชุฑุงุญ ููุฒุงุช: ูุฑุญุจ ุจูุณุงููุชู!"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ ุงููุธุงู ุณูุนูู ุฎูุงู ุซูุงูู..."
echo "โ๏ธ  ูุฏ ุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู ุฃู ุฅุนุงุฏุฉ ุงูุชุดุบูู ููุชุทุจูู ุงููุงูู"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ุฅุธูุงุฑ ูุคุดุฑ ุชูุฏู ููุงุฆู
echo -n "๐ ุฌุงุฑู ุงูุฅููุงุก "
for i in {1..10}; do
    echo -n "."
    sleep 0.3
done
echo " โ"

# ุชูุธูู ูุคูุช
rm -f /tmp/gt-*.tmp 2>/dev/null || true

# ุงุฎุชุจุงุฑ ุณุฑูุน ููุงุฆู
echo ""
echo "๐ ุงุฎุชุจุงุฑ ุณุฑูุน ูููุธุงู:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"

# ุงุฎุชุจุงุฑ ุงูุฃูุงูุฑ
TEST_COMMANDS=("gtsalat" "gt-launcher")
for cmd in "${TEST_COMMANDS[@]}"; do
    if command -v "$cmd" >/dev/null 2>&1; then
        echo -e "โ $cmd - ุฌุงูุฒ ููุงุณุชุฎุฏุงู"
    else
        echo -e "โ๏ธ  $cmd - ุฌุฑุจ ุฅุนุงุฏุฉ ูุชุญ ุงูุทุฑููุฉ ุฃู: source ~/.bashrc"
    fi
done

# ุงุฎุชุจุงุฑ ูููุงุช
echo ""
echo "๐ ุงูุชุญูู ูู ุงููููุงุช ุงูุฑุฆูุณูุฉ:"
if [ -f "$INSTALL_DIR/$MAIN_SCRIPT" ]; then
    echo -e "โ ุงูููู ุงูุฑุฆูุณู - ููุฌูุฏ"
else
    echo -e "โ ุงูููู ุงูุฑุฆูุณู - ููููุฏ"
fi

if [ -f "$TRAY_SCRIPT" ]; then
    echo -e "โ System Tray - ููุฌูุฏ"
else
    echo -e "โ System Tray - ููููุฏ"
fi

if [ -f "$UNIVERSAL_LAUNCHER" ]; then
    echo -e "โ Launcher ุนุงููู - ููุฌูุฏ"
else
    echo -e "โ Launcher ุนุงููู - ููููุฏ"
fi

# ุงูุชุญูู ูู ุฃููููุฉ ุงููุงุฆูุฉ
if [ -f "$HOME/.local/share/applications/gt-salat-dikr.desktop" ]; then
    echo -e "โ ุฃููููุฉ ุงููุงุฆูุฉ - ููุฌูุฏุฉ"
    echo -e "   ๐ ุงููููุน: $HOME/.local/share/applications/gt-salat-dikr.desktop"
else
    echo -e "โ๏ธ  ุฃููููุฉ ุงููุงุฆูุฉ - ููููุฏุฉุ ููููู ุฅูุดุงุคูุง ูุฏููุงู"
fi

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ุฅูุดุงุก ููู ุงุฎุชุตุงุฑ ูููุณุชุฎุฏู
GUIDE_FILE="$HOME/ุฏููู-ุงุณุชุฎุฏุงู-GT-salat-dikr.txt"
cat > "$GUIDE_FILE" << GUIDE_EOF
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            ๐ ุฏููู ุงุณุชุฎุฏุงู GT-salat-dikr ๐
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ฐ ุงูููุฏูุฉ
ุชู ุชุซุจูุช GT-salat-dikr ุจูุฌุงุญ! ูุฐุง ุงูุจุฑูุงูุฌ ุณูุณุงุนุฏู ุนูู:
โข ุชุฐูุฑ ููุงููุช ุงูุตูุงุฉ ุชููุงุฆูุงู
โข ุนุฑุถ ุงูุฃุฐูุงุฑ ุงููุฃุซูุฑุฉ ูู 10 ุฏูุงุฆู
โข ุงูุชูุจูู ูุจู ุงูุตูุงุฉ ุจู 15 ุฏูููุฉ
โข ุงูุนูู ุจุฏูู ุงุชุตุงู ุจุงูุฅูุชุฑูุช

๐ ุงููููุงุช ุงููุซุจุชุฉ
๐ ุงููุซุจุช: $INSTALL_DIR/
๐ Launcher ุนุงููู: $UNIVERSAL_LAUNCHER
๐ System Tray: $TRAY_SCRIPT
๐ ุฅูุบุงุก ุชุซุจูุช: $UNINSTALLER

๐ ููููุฉ ุงูุจุฏุก
1. ุงูุชุญ ูุงุฆูุฉ ุงูุชุทุจููุงุช
2. ุงุจุญุซ ุนู "GT-salat-dikr"
3. ุงููุฑ ุนูู ุงูุฃููููุฉ
4. ุงูุชุธุฑ 5-10 ุซูุงูู

ุฃู ุงุณุชุฎุฏู ุงูุฃูุงูุฑ ุงูุชุงููุฉ ูู ุงูุทุฑููุฉ:
gtsalat                    # ุนุฑุถ ุฐูุฑ ูููุนุฏ ุงูุตูุงุฉ
gt-launcher               # ูุงุฌูุฉ ุงูุชุญูู
gt-salat-launcher         # Launcher ุนุงููู

๐ง ุงูุฃูุงูุฑ ุงูุฑุฆูุณูุฉ
gtsalat --status          # ุญุงูุฉ ุงูุจุฑูุงูุฌ
gtsalat --show-timetable  # ููุงููุช ุงูููู
gtsalat --settings        # ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช
gtsalat --notify-stop     # ุฅููุงู ุงูุฅุดุนุงุฑุงุช
gtsalat --notify-start    # ุจุฏุก ุงูุฅุดุนุงุฑุงุช

๐ฅ๏ธ System Tray
โข ุณุชุธูุฑ ุฃููููุฉ ูู ุดุฑูุท ุงูููุงู
โข ุงููุฑ ุจุฒุฑ ุงููุงูุณ ุงูุฃููู ููุชุญูู
โข ููููู ุฅุฎูุงุก/ุฅุธูุงุฑ ุงูุฅุดุนุงุฑุงุช
โข ุงูุชุญูู ูู ูุณุชูู ุงูุตูุช

โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ
โข ูุงุตู ุงูุฃุฐูุงุฑ: 10 ุฏูุงุฆู
โข ุชูุจูู ูุจู ุงูุตูุงุฉ: 15 ุฏูููุฉ
โข ุชุญุฏูุซ ุชููุงุฆู: 2 ุตุจุงุญุงู ูู ููู
โข ุงูุฃุฐุงู: ุงูุตูุช ุงููุงูู

๐๏ธ ูุฅูุบุงุก ุงูุชุซุจูุช
bash $UNINSTALLER
ุฃู
gtsalat --uninstall

๐ ุงูุฏุนู
https://github.com/SalehGNUTUX/GT-salat-dikr

ุชู ุงูุชุซุจูุช ุจุชุงุฑูุฎ: $(date)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
GUIDE_EOF

echo "๐ ุชู ุฅูุดุงุก ุฏููู ุงูุงุณุชุฎุฏุงู ูู: $GUIDE_FILE"
echo ""

# ุงูุชุฑุงุญ ุงูุฎุทูุฉ ุงูุชุงููุฉ
echo "๐ก ุงูุฎุทูุฉ ุงูุชุงููุฉ ุงูููุชุฑุญุฉ:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. ุฃุนุฏ ูุชุญ ุงูุทุฑููุฉ ุฃู ุชุดุบูู: source ~/.bashrc"
echo "2. ุงูุชุญ ูุงุฆูุฉ ุงูุชุทุจููุงุช ูุงุจุญุซ ุนู 'GT-salat-dikr'"
echo "3. ุงููุฑ ุนูู ุงูุฃููููุฉ ูุจุฏุก ุงูุงุณุชุฎุฏุงู"
echo "4. ุฅุฐุง ูู ุชุธูุฑ ุงูุฃููููุฉุ ุฌุฑุจ: gt-salat-launcher"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ูุตุงุฆุญ ููุงุฆูุฉ
echo "โจ ูุตุงุฆุญ ูููุฉ:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โข ุฅุฐุง ููุช ุชุณุชุฎุฏู KDE Plasmaุ ุงุจุญุซ ูู 'ุงูุชุนููู' ุฃู 'ุงูุฃุฏูุงุช'"
echo "โข ุฅุฐุง ููุช ุชุณุชุฎุฏู GNOMEุ ุงูุชุจ 'GT-salat' ูู ุดุฑูุท ุงูุจุญุซ"
echo "โข System Tray ุณูุธูุฑ ุจุนุฏ 15-20 ุซุงููุฉ ูู ุงูุชุดุบูู"
echo "โข ููููู ุฅุนุงุฏุฉ ุชุซุจูุช ููุชุจุงุช Python ูุงุญูุงู ุฅุฐุง ุงุญุชุงุฌ ุงูุฃูุฑ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ุณุฌู ุงูุชุซุจูุช
LOG_FILE="$INSTALL_DIR/install.log"
echo "==================================================" >> "$LOG_FILE"
echo "ุชุซุจูุช ุฌุฏูุฏ - $(date)" >> "$LOG_FILE"
echo "ุงูุฅุตุฏุงุฑ: 3.2.5" >> "$LOG_FILE"
echo "ุงููุณุงุฑ: $INSTALL_DIR" >> "$LOG_FILE"
echo "ุงููุณุชุฎุฏู: $USER" >> "$LOG_FILE"
echo "ุงูุชูุฒูุนุฉ: $(lsb_release -d 2>/dev/null | cut -f2 || uname -a)" >> "$LOG_FILE"
echo "==================================================" >> "$LOG_FILE"

# ุฑุณุงูุฉ ูุฏุงุน ูููุฉ
cat << "EOF"

      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
      โ                                      โ
      โ   ๐ ุชู ุงูุชุซุจูุช ุจูุฌุงุญ! ๐           โ
      โ                                      โ
      โ   ุงุณุชูุชุน ุจุชุฌุฑุจุฉ GT-salat-dikr       โ
      โ   ููุง ุชูุณูุง ูู ุฏุนุงุฆู!               โ
      โ                                      โ
      โ   ูุน ุชุญูุงุช:                         โ
      โ   ูุฑูู GT-salat-dikr                โ
      โ                                      โ
      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ุชุงุจุนูุง ูููุฒูุฏ ูู ุงูุชุทููุฑุงุช: https://github.com/SalehGNUTUX

EOF

echo ""
echo "๐ ูุน ุงูุณูุงูุฉ! ููููู ุงูุฎุฑูุฌ ุงูุขู."
echo "๐ก ุชุฐูุฑ: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุทุฑููุฉ ูุฏ ุชููู ุถุฑูุฑูุฉ ููุฃูุงูุฑ ุงูุฌุฏูุฏุฉ."

exit 0
